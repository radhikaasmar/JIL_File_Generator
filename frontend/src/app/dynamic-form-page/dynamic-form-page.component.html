<div class="dynamic-form-container">
  <div class="form-header">
    <h1>Dynamic Form Viewer</h1>
    
    <!-- Download JIL Button -->
    <button type="button" class="btn btn-primary download-btn" (click)="downloadJILFiles()">
      <span>üì•</span> Download JIL Files
    </button>
    
    <!-- Add Function Section -->
    <div class="add-function-section">
      <label>Add Function of Job:</label>
      <div class="function-checkbox-list">
        <label *ngFor="let option of availableFunctionOptions">
          <input type="checkbox" 
                 [value]="option.value"
                 (change)="onFunctionCheckboxChange($event, option)">
          {{ option.label }}
        </label>
      </div>
    </div>
  </div>

  <div class="subforms-container">
    <div *ngFor="let instance of subformInstances; trackBy: trackByInstanceId" 
         class="subform-wrapper">
      
      <div class="subform-header">
        <h2>{{ instance.displayName }}</h2>
        <button *ngIf="instance.removable" 
                type="button" 
                class="remove-btn"
                (click)="removeSubformInstance(instance.id)">
          Remove
        </button>
      </div>

      <!-- Job name display for each subform -->
      <div *ngIf="getJobNameForInstance(instance)" class="job-name-display">
        <strong>Job Name:</strong> {{ getJobNameForInstance(instance) }}
        <div *ngIf="isJobNameTruncated(instance)" class="warning">
          ‚ö†Ô∏è Job name has been truncated to fit 60 character limit
        </div>
      </div>

      <app-dynamic-form-viewer 
        [sections]="instance.sections"
        [form]="instance.form"
        [subformContext]="instance"
        (formChange)="onSubformChange(instance)">
      </app-dynamic-form-viewer>
    </div>
  </div>
</div>
